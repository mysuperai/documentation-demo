(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{127:function(e,r,t){"use strict";t.r(r),t.d(r,"frontMatter",(function(){return s})),t.d(r,"metadata",(function(){return c})),t.d(r,"toc",(function(){return l})),t.d(r,"default",(function(){return p}));var n=t(3),i=t(7),o=(t(0),t(204)),s={sidebar_label:"referer",title:"scrapy.spidermiddlewares.referer"},c={unversionedId:"scrapy/scrapy/spidermiddlewares/referer",id:"scrapy/scrapy/spidermiddlewares/referer",isDocsHomePage:!1,title:"scrapy.spidermiddlewares.referer",description:"RefererMiddleware: populates Request referer field, based on the Response which",source:"@site/docs/scrapy/scrapy/spidermiddlewares/referer.md",sourceDirName:"scrapy/scrapy/spidermiddlewares",slug:"/scrapy/scrapy/spidermiddlewares/referer",permalink:"/documentation-demo/docs/scrapy/scrapy/spidermiddlewares/referer",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/scrapy/scrapy/spidermiddlewares/referer.md",version:"current",sidebar_label:"referer",frontMatter:{sidebar_label:"referer",title:"scrapy.spidermiddlewares.referer"},sidebar:"tutorialSidebar",previous:{title:"scrapy.spidermiddlewares.offsite",permalink:"/documentation-demo/docs/scrapy/scrapy/spidermiddlewares/offsite"},next:{title:"scrapy.spiders",permalink:"/documentation-demo/docs/scrapy/scrapy/spiders/__init__"}},l=[{value:"ReferrerPolicy Objects",id:"referrerpolicy-objects",children:[]},{value:"NoReferrerPolicy Objects",id:"noreferrerpolicy-objects",children:[]},{value:"NoReferrerWhenDowngradePolicy Objects",id:"noreferrerwhendowngradepolicy-objects",children:[]},{value:"SameOriginPolicy Objects",id:"sameoriginpolicy-objects",children:[]},{value:"OriginPolicy Objects",id:"originpolicy-objects",children:[]},{value:"StrictOriginPolicy Objects",id:"strictoriginpolicy-objects",children:[]},{value:"OriginWhenCrossOriginPolicy Objects",id:"originwhencrossoriginpolicy-objects",children:[]},{value:"StrictOriginWhenCrossOriginPolicy Objects",id:"strictoriginwhencrossoriginpolicy-objects",children:[]},{value:"UnsafeUrlPolicy Objects",id:"unsafeurlpolicy-objects",children:[]},{value:"DefaultReferrerPolicy Objects",id:"defaultreferrerpolicy-objects",children:[]},{value:"RefererMiddleware Objects",id:"referermiddleware-objects",children:[]}],a={toc:l};function p(e){var r=e.components,t=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},a,t,{components:r,mdxType:"MDXLayout"}),Object(o.b)("p",null,"RefererMiddleware: populates Request referer field, based on the Response which\noriginated it."),Object(o.b)("h2",{id:"referrerpolicy-objects"},"ReferrerPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class ReferrerPolicy()\n")),Object(o.b)("h4",{id:"strip_url"},"strip","_","url"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"}," | strip_url(url, origin_only=False)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#strip-url"},"https://www.w3.org/TR/referrer-policy/#strip-url")),Object(o.b)("p",null,"If url is null, return no referrer.\nIf url","'","s scheme is a local scheme, then return no referrer.\nSet url","'","s username to the empty string.\nSet url","'","s password to null.\nSet url","'","s fragment to null.\nIf the origin-only flag is true, then:\nSet url","'","s path to null.\nSet url","'","s query to null.\nReturn url."),Object(o.b)("h4",{id:"origin"},"origin"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"}," | origin(url)\n")),Object(o.b)("p",null,"Return serialized origin (scheme, host, path) for a request or response URL."),Object(o.b)("h2",{id:"noreferrerpolicy-objects"},"NoReferrerPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class NoReferrerPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-no-referrer"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-no-referrer")),Object(o.b)("p",null,"The simplest policy is ",'"',"no-referrer",'"',", which specifies that no referrer information\nis to be sent along with requests made from a particular request client to any origin.\nThe header will be omitted entirely."),Object(o.b)("h2",{id:"noreferrerwhendowngradepolicy-objects"},"NoReferrerWhenDowngradePolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class NoReferrerWhenDowngradePolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-no-referrer-when-downgrade"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-no-referrer-when-downgrade")),Object(o.b)("p",null,"The ",'"',"no-referrer-when-downgrade",'"'," policy sends a full URL along with requests\nfrom a TLS-protected environment settings object to a potentially trustworthy URL,\nand requests from clients which are not TLS-protected to any origin."),Object(o.b)("p",null,"Requests from TLS-protected clients to non-potentially trustworthy URLs,\non the other hand, will contain no referrer information.\nA Referer HTTP header will not be sent."),Object(o.b)("p",null,"This is a user agent","'","s default behavior, if no policy is otherwise specified."),Object(o.b)("h2",{id:"sameoriginpolicy-objects"},"SameOriginPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class SameOriginPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-same-origin"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-same-origin")),Object(o.b)("p",null,"The ",'"',"same-origin",'"'," policy specifies that a full URL, stripped for use as a referrer,\nis sent as referrer information when making same-origin requests from a particular request client."),Object(o.b)("p",null,"Cross-origin requests, on the other hand, will contain no referrer information.\nA Referer HTTP header will not be sent."),Object(o.b)("h2",{id:"originpolicy-objects"},"OriginPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class OriginPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-origin"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-origin")),Object(o.b)("p",null,"The ",'"',"origin",'"'," policy specifies that only the ASCII serialization\nof the origin of the request client is sent as referrer information\nwhen making both same-origin requests and cross-origin requests\nfrom a particular request client."),Object(o.b)("h2",{id:"strictoriginpolicy-objects"},"StrictOriginPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class StrictOriginPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-strict-origin"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-strict-origin")),Object(o.b)("p",null,"The ",'"',"strict-origin",'"'," policy sends the ASCII serialization\nof the origin of the request client when making requests:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"from a TLS-protected environment settings object to a potentially trustworthy URL, and"),Object(o.b)("li",{parentName:"ul"},"from non-TLS-protected environment settings objects to any origin.")),Object(o.b)("p",null,"Requests from TLS-protected request clients to non- potentially trustworthy URLs,\non the other hand, will contain no referrer information.\nA Referer HTTP header will not be sent."),Object(o.b)("h2",{id:"originwhencrossoriginpolicy-objects"},"OriginWhenCrossOriginPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class OriginWhenCrossOriginPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-origin-when-cross-origin"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-origin-when-cross-origin")),Object(o.b)("p",null,"The ",'"',"origin-when-cross-origin",'"'," policy specifies that a full URL,\nstripped for use as a referrer, is sent as referrer information\nwhen making same-origin requests from a particular request client,\nand only the ASCII serialization of the origin of the request client\nis sent as referrer information when making cross-origin requests\nfrom a particular request client."),Object(o.b)("h2",{id:"strictoriginwhencrossoriginpolicy-objects"},"StrictOriginWhenCrossOriginPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class StrictOriginWhenCrossOriginPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-strict-origin-when-cross-origin"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-strict-origin-when-cross-origin")),Object(o.b)("p",null,"The ",'"',"strict-origin-when-cross-origin",'"'," policy specifies that a full URL,\nstripped for use as a referrer, is sent as referrer information\nwhen making same-origin requests from a particular request client,\nand only the ASCII serialization of the origin of the request client\nwhen making cross-origin requests:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"from a TLS-protected environment settings object to a potentially trustworthy URL, and"),Object(o.b)("li",{parentName:"ul"},"from non-TLS-protected environment settings objects to any origin.")),Object(o.b)("p",null,"Requests from TLS-protected clients to non- potentially trustworthy URLs,\non the other hand, will contain no referrer information.\nA Referer HTTP header will not be sent."),Object(o.b)("h2",{id:"unsafeurlpolicy-objects"},"UnsafeUrlPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class UnsafeUrlPolicy(ReferrerPolicy)\n")),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://www.w3.org/TR/referrer-policy/#referrer-policy-unsafe-url"},"https://www.w3.org/TR/referrer-policy/#referrer-policy-unsafe-url")),Object(o.b)("p",null,"The ",'"',"unsafe-url",'"'," policy specifies that a full URL, stripped for use as a referrer,\nis sent along with both cross-origin requests\nand same-origin requests made from a particular request client."),Object(o.b)("p",null,"Note: The policy","'","s name doesn","'","t lie; it is unsafe.\nThis policy will leak origins and paths from TLS-protected resources\nto insecure origins.\nCarefully consider the impact of setting such a policy for potentially sensitive documents."),Object(o.b)("h2",{id:"defaultreferrerpolicy-objects"},"DefaultReferrerPolicy Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class DefaultReferrerPolicy(NoReferrerWhenDowngradePolicy)\n")),Object(o.b)("p",null,"A variant of ",'"',"no-referrer-when-downgrade",'"',",\nwith the addition that ",'"',"Referer",'"'," is not sent if the parent request was\nusing ",Object(o.b)("inlineCode",{parentName:"p"},"file://")," or ",Object(o.b)("inlineCode",{parentName:"p"},"s3://")," scheme."),Object(o.b)("h2",{id:"referermiddleware-objects"},"RefererMiddleware Objects"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"},"class RefererMiddleware()\n")),Object(o.b)("h4",{id:"policy"},"policy"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-python"}," | policy(resp_or_url, request)\n")),Object(o.b)("p",null,"Determine Referrer-Policy to use from a parent Response (or URL),\nand a Request to be sent."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"if a valid policy is set in Request meta, it is used."),Object(o.b)("li",{parentName:"ul"},"if the policy is set in meta but is wrong (e.g. a typo error),\nthe policy from settings is used"),Object(o.b)("li",{parentName:"ul"},"if the policy is not set in Request meta,\nbut there is a Referrer-policy header in the parent response,\nit is used if valid"),Object(o.b)("li",{parentName:"ul"},"otherwise, the policy from settings is used.")))}p.isMDXComponent=!0},204:function(e,r,t){"use strict";t.d(r,"a",(function(){return b})),t.d(r,"b",(function(){return d}));var n=t(0),i=t.n(n);function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(i[t]=e[t]);return i}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var a=i.a.createContext({}),p=function(e){var r=i.a.useContext(a),t=r;return e&&(t="function"==typeof e?e(r):c(c({},r),e)),t},b=function(e){var r=p(e.components);return i.a.createElement(a.Provider,{value:r},e.children)},u={inlineCode:"code",wrapper:function(e){var r=e.children;return i.a.createElement(i.a.Fragment,{},r)}},f=i.a.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,a=l(e,["components","mdxType","originalType","parentName"]),b=p(t),f=n,d=b["".concat(s,".").concat(f)]||b[f]||u[f]||o;return t?i.a.createElement(d,c(c({ref:r},a),{},{components:t})):i.a.createElement(d,c({ref:r},a))}));function d(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,s=new Array(o);s[0]=f;var c={};for(var l in r)hasOwnProperty.call(r,l)&&(c[l]=r[l]);c.originalType=e,c.mdxType="string"==typeof e?e:n,s[1]=c;for(var a=2;a<o;a++)s[a]=t[a];return i.a.createElement.apply(null,s)}return i.a.createElement.apply(null,t)}f.displayName="MDXCreateElement"}}]);